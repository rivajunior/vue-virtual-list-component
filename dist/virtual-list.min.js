var VirtualList=function(t,e){"use strict";var i=function(t,e){var i;return function(){var s=this,r=arguments,a=function(){i=null,t.apply(s,r)};clearTimeout(i),(i=setTimeout(a,e))||t.apply(s,r)}},s={name:"VirtualList",props:{itemHeight:{type:Number,required:!0},remain:{type:Number,required:!0},rtag:{type:String,default:"div"},wtag:{type:String,default:"div"},wclass:{type:String,default:""},pagemode:Boolean,scrollelement:{type:"undefined"==typeof window?Object:HTMLElement,default:null},start:{type:Number,default:0},offset:{type:Number,default:0},variable:{type:[Function,Boolean],default:!1},bench:{type:Number,default:0},debounce:{type:Number,default:0},totop:{type:[Function,Boolean],default:!1},tobottom:{type:[Function,Boolean],default:!1},onscroll:{type:[Function,Boolean],default:!1},item:{type:Object,default:null},itemcount:{type:Number,default:0},itemprops:{type:Function,default:function(){}}},watch:{itemHeight:function(){this.changeProp="itemHeight"},remain:function(){this.changeProp="remain"},bench:function(){this.changeProp="bench",this.itemModeForceRender()},start:function(){this.changeProp="start",this.itemModeForceRender()},offset:function(){this.changeProp="offset",this.itemModeForceRender()},itemcount:function(){this.changeProp="itemcount",this.itemModeForceRender()},scrollelement:function(t,e){this.pagemode||(e&&this.removeScrollListener(e),t&&this.addScrollListener(t))}},created:function(){var t=this.start>=this.remain?this.start:0,e=this.remain+(this.bench||this.remain),i=Object.create(null);i.direction="",i.scrollTop=0,i.start=t,i.end=t+e-1,i.keeps=e,i.total=0,i.offsetAll=0,i.paddingTop=0,i.paddingBottom=0,i.varCache={},i.varAverItemHeight=0,i.varLastCalcIndex=0,this.delta=i},mounted:function(){if(this.pagemode?this.addScrollListener(window):this.scrollelement&&this.addScrollListener(this.scrollelement),this.start){var t=this.getZone(this.start).start;this.setScrollTop(this.variable?this.getVarOffset(t):t*this.itemHeight)}else this.offset&&this.setScrollTop(this.offset)},beforeDestroy:function(){this.pagemode?this.removeScrollListener(window):this.scrollelement&&this.removeScrollListener(this.scrollelement)},beforeUpdate:function(){var t=this.delta,e="start"===this.changeProp?this.start:t.start,i=this.getZone(e);if(t.keeps=this.remain+(this.bench||this.remain),this.changeProp&&["start","itemHeight","offset"].includes(this.changeProp)){var s="offset"===this.changeProp?this.offset:this.variable?this.getVarOffset(i.isLast?t.total:i.start):i.isLast&&t.total-e<=this.remain?t.total*this.itemHeight:e*this.itemHeight;this.$nextTick(this.setScrollTop.bind(this,s))}},updated:function(){var t=this.delta,e="start"===this.changeProp?this.start:t.start,i=this.getZone(e);t.keeps=this.remain+(this.bench||this.remain),(this.changeProp||t.end!==i.end&&!i.isLast||e!==i.start)&&(this.changeProp="",t.end=i.end,t.start=i.start,this.forceRender())},methods:{addScrollListener:function(t){this.scrollHandler=this.debounce?i(this.onScroll.bind(this),this.debounce):this.onScroll,t.addEventListener("scroll",this.scrollHandler,!1)},removeScrollListener:function(t){t.removeEventListener("scroll",this.scrollHandler,!1)},onScroll:function(t){var e,i=this.delta,s=this.$refs.vsl,r=i.offsetAll;if(this.pagemode)e=-this.$el.getBoundingClientRect().top;else if(this.scrollelement){var a=this.scrollelement.getBoundingClientRect(),n=this.$el.getBoundingClientRect();e=a.top-n.top}else e=(s.$el||s).scrollTop||0;if(i.direction=e>i.scrollTop?"D":"U",i.scrollTop=e,i.total>i.keeps?this.updateZone(e):i.end=i.total-1,this.onscroll){var o=Object.create(null);o.offset=e,o.offsetAll=r,o.start=i.start,o.end=i.end,this.onscroll(t,o)}!e&&i.total&&this.fireEvent("totop"),e>=r&&this.fireEvent("tobottom")},updateZone:function(t){var e=this.delta,i=this.variable?this.getVarOvers(t):Math.floor(t/this.itemHeight);"U"===e.direction&&(i=i-this.remain+1);var s=this.getZone(i),r=this.bench||this.remain,a=1===Math.abs(i-e.start-r);!a&&i-e.start<=r&&!s.isLast&&i>e.start||(a||s.start!==e.start||s.end!==e.end)&&(e.end=s.end,e.start=s.start,this.forceRender())},getZone:function(t){var e,i,s=this.delta,r=s.total-s.keeps;return t=parseInt(t,10),{end:(e=(i=(t=Math.max(0,t))<=s.total&&t>=r||t>s.total)?Math.max(0,r):t)+s.keeps-1,start:e,isLast:i}},forceRender:function(){var t=this;window.requestAnimationFrame((function(){t.$forceUpdate()}))},itemModeForceRender:function(){this.item&&this.forceRender()},getVarOvers:function(t){for(var e=this.delta,i=0,s=0,r=0,a=e.total;i<=a;){if(s=i+Math.floor((a-i)/2),r=this.getVarOffset(s),e.varAverItemHeight||(e.varAverItemHeight=Math.floor(r/s)),r===t)return s;r<t?i=s+1:r>t&&(a=s-1)}return i>0?--i:0},getVarOffset:function(t,e){var i=this.delta,s=i.varCache[t],r=0;if(!e&&s)return s.offset;for(var a=0;a<t;a++){var n=this.getVarItemHeight(a,e);i.varCache[a]={itemHeight:n,offset:r},r+=n}return i.varLastCalcIndex=Math.max(i.varLastCalcIndex,t-1),i.varLastCalcIndex=Math.min(i.varLastCalcIndex,i.total-1),r},getVarItemHeight:function(t,e){var i=this.delta.varCache[t];if(!e&&i)return i.itemHeight;if("function"==typeof this.variable)return this.variable(t)||0;var s=this.item?this.$children[t]?this.$children[t].$vnode:null:this.$slots.default[t],r=s&&s.data&&s.data.style;if(r&&r.height){var a=r.height.match(/^(.*)px$/);return a&&+a[1]||0}return 0},getVarPaddingTop:function(){return this.getVarOffset(this.delta.start)},getVarPaddingBottom:function(){var t=this.delta,e=t.total-1;return t.total-t.end<=t.keeps||t.varLastCalcIndex===e?this.getVarOffset(e)-this.getVarOffset(t.end):(t.total-t.end)*(t.varAverItemHeight||this.itemHeight)},getVarAllHeight:function(){var t=this.delta;return t.total-t.end<=t.keeps||t.varLastCalcIndex===t.total-1?this.getVarOffset(t.total):this.getVarOffset(t.start)+(t.total-t.end)*(t.varAverItemHeight||this.itemHeight)},updateVariable:function(t){this.getVarOffset(t,!0)},fireEvent:function(t){this[t]&&this[t]()},setScrollTop:function(t){if(this.pagemode)window.scrollTo(0,t);else if(this.scrollelement)this.scrollelement.scrollTo(0,t);else{var e=this.$refs.vsl;e&&((e.$el||e).scrollTop=t)}},filter:function(t){var e,i,s,r,a=this.delta,n=this.$slots.default||[],o=[];this.item?(a.total=this.itemcount,a.keeps>a.total&&(a.end=a.total-1)):(n.length||(a.start=0),a.total=n.length),r=a.total>a.keeps,this.variable?(s=this.getVarAllHeight(),e=r?this.getVarPaddingTop():0,i=r?this.getVarPaddingBottom():0):(s=this.itemHeight*a.total,e=this.itemHeight*(r?a.start:0),i=this.itemHeight*(r?a.total-a.keeps:0)-e),i<this.itemHeight&&(i=0),a.paddingTop=e,a.paddingBottom=i,a.offsetAll=s-this.itemHeight*this.remain;for(var l=a.start;l<a.total&&l<=Math.ceil(a.end);l++){var h=null;h=this.item?t(this.item,this.itemprops(l)):n[l],o.push(h)}return o}},render:function(t){var e=this.debounce,s=this.filter(t),r=this.delta,a=r.paddingTop,n=r.paddingBottom,o=t(this.wtag,{style:{display:"block","padding-top":a+"px","padding-bottom":n+"px"},class:this.wclass,attrs:{role:"group"}},s);return this.pagemode||this.scrollelement?o:t(this.rtag,{ref:"vsl",style:{display:"block","overflow-y":this.itemHeight>=this.remain?"auto":"inital",height:this.itemHeight*this.remain+"px"},on:{"&scroll":e?i(this.onScroll.bind(this),e):this.onScroll}},[o])}},r=e.normalizeComponent({},void 0,s,void 0,void 0,void 0,!1,void 0,void 0,void 0);function a(t){a.installed||(a.installed=!0,t.component("VirtualList",r))}var n={install:a},o=null;return"undefined"!=typeof window?o=window.Vue:"undefined"!=typeof global&&(o=global.Vue),o&&o.use(n),r.install=a,t.default=r,t}({},vueRuntimeHelpers);